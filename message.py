import astronum
import content
import utils

DICT_MSG = {
    'hi': '–ë–∏–ø-–±–∏–ø-–±—É–ø-—É–∏–ø! <code>[..—è–∑—ã–∫ –∑–∞–≥—Ä—É–∂–µ–Ω..]</code> –ù—É, —Ç–æ –µ—Å—Ç—å, '
    '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ú–æ–µ –∏–º—è <b>D06V1</b>, –Ω–æ –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–∑—ã–≤–∞—Ç—å –º–µ–Ω—è '
    '<b>–î–µ–π–ª</b>. –Ø —Ä–æ–±–æ—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥—ç–π–ª–∏-–ø–æ–º–æ—â–Ω–∏–∫ü§ñ',

    'get_name': '<code>[–ó–ê–ì–†–£–ó–ö–ê –ü–†–û–¢–û–ö–û–õ–ê "–ó–ù–ê–ö–û–ú–°–¢–í–û"]</code>\n–ò—Å–ø—ã—Ç—ã–≤–∞—é '
    '–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –í–∞—Å. –ù–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –í–∞—à–µ –§–ò–û:',

    'get_city': '{}, –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ c–±–æ—Ä–∞ –º–µ—Ç–µ–æ–¥–∞–Ω–Ω—ã—Ö —Å–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤ –∏ '
    '–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –í–∞–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–≥–æ–¥–µ, –º–Ω–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ '
    '—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –í–∞—à—É –≥–µ–æ–ø–æ–∑–∏—Ü–∏—é. –£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ –í–∞—à–µ–≥–æ '
    '–Ω–∞—Å–µ–ª–µ–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞:',

    'get_city_2': '‚úÖ<code>[–£–°–ü–ï–®–ù–û]: –í–∞–ª–∏–¥–∞—Ü–∏—è –§–ò–û –ø—Ä–æ–π–¥–µ–Ω–∞.</code>\n–û—á–µ–Ω—å '
    '–ø—Ä–∏—è—Ç–Ω–æ, {}! –î–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ c–±–æ—Ä–∞ –º–µ—Ç–µ–æ–¥–∞–Ω–Ω—ã—Ö —Å–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤ –∏ '
    '–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –í–∞–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–≥–æ–¥–µ, –º–Ω–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ '
    '—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –í–∞—à—É –≥–µ–æ–ø–æ–∑–∏—Ü–∏—é. –£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ –í–∞—à–µ–≥–æ '
    '–Ω–∞—Å–µ–ª–µ–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞:',

    'get_bday': '{}, –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, '
    '–¥–∞—Ç—É –í–∞—à–µ–≥–æ —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ <code>–î–î.–ú–ú.–ì–ì–ì–ì</code>:',

    'get_bday_2': '‚úÖ<code>[–£–°–ü–ï–®–ù–û]: –ù–∞—Å–µ–ª—ë–Ω–Ω—ã–π –ø—É–Ω–∫—Ç "{}" –Ω–∞–π–¥–µ–Ω. '
    '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–ø—É—Ç–Ω–∏–∫–∞–º –∑–∞–≤–µ—Ä—à–µ–Ω–æ.</code>\n{}, –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è '
    '–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–∞—Ç—É –í–∞—à–µ–≥–æ —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ '
    '–î–î.–ú–ú.–ì–ì–ì–ì:',

    'welcome_back': '‚úÖ<code>[–£–°–ü–ï–®–ù–û]: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞.</code>\n{}, '
    '—Ä–∞–¥ –≤–Ω–æ–≤—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –í–∞—Å! –Ø –ø—Ä–æ–¥–æ–ª–∂—É –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –í–∞–º '
    '–ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 6:00 –ø–æ —á–∞—Å–æ–≤–æ–º—É –ø–æ—è—Å—É GMT+3 '
    '(–ú–æ—Å–∫–≤–∞)',

    'registration_1': '–ú–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–æ–∫–∞ —Å–∏–ª—å–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω, –Ω–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å '
    '—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥ –º–æ–∏–º –∫–æ–¥–æ–º –∫–∞–∂–¥—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å '
    '–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.',

    'registration_2': '–ü–æ—Å–ª–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —è –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –¥–∞–Ω–Ω—ã–µ –∏ –≤ –Ω–∞—á–∞–ª–µ '
    '–∫–∞–∂–¥–æ–≥–æ –Ω–æ–≤–æ–≥–æ –¥–Ω—è –±—É–¥—É –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –í–∞–º –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:\n-–ü—Ä–æ–≥–Ω–æ–∑ '
    '–ø–æ–≥–æ–¥—ã\n-–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –ø–æ–ª–æ–∂–µ–Ω–∏–∏ –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö —Ç–µ–ª\n'
    '-–°–ª—É—á–∞–π–Ω–æ–µ –º–æ—Ç–∏–≤–∏—Ä—É—é—â–µ–µ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ\n-–°–ª—É—á–∞–π–Ω–æ–µ –∫–∏–Ω–æ–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ',

    'invalid_name': '‚ùå<code>[–û–®–ò–ë–ö–ê]: –§–ò–û –¥–æ–ª–∂–Ω–æ —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ 3 —Å–ª–æ–≤.</code>\n'
    '–ß—Ç–æ–±—ã –º–æ–∏ —Å–ª—É–∂–±—ã —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø—Ä–æ—à—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –º–Ω–µ –í–∞—à–µ –ø–æ–ª–Ω–æ–µ '
    '–§–ò–û:',

    'invalid_city': '‚ùå<code>[–û–®–ò–ë–ö–ê]: –ù–∞—Å–µ–ª—ë–Ω–Ω—ã–π –ø—É–Ω–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ –ø–ª–∞–Ω–µ—Ç–µ '
    '–ó–µ–º–ª—è.</code>\n–ß—Ç–æ–±—ã –º–æ–∏ —Å–ª—É–∂–±—ã —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø—Ä–æ—à—É —É–∫–∞–∑–∞—Ç—å '
    '—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã–π –ø—É–Ω–∫—Ç',

    'invalid_bday': '‚ùå<code>[–û–®–ò–ë–ö–ê]: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã.</code>\n'
    '–ß—Ç–æ–±—ã –º–æ–∏ —Å–ª—É–∂–±—ã —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø—Ä–æ—à—É —É–∫–∞–∑–∞—Ç—å –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –≤ '
    '—Ñ–æ—Ä–º–∞—Ç–µ –î–î.–ú–ú.–ì–ì–ì–ì',

    'bday_in_future': '‚ùå<code>[–û–®–ò–ë–ö–ê]: –î–∞—Ç–∞ –∏–∑ –±—É–¥—É—â–µ–≥–æ.</code>\n'
    '–ß—Ç–æ–±—ã –º–æ–∏ —Å–ª—É–∂–±—ã —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø—Ä–æ—à—É —É–∫–∞–∑–∞—Ç—å –í–∞—à—É —Ä–µ–∞–ª—å–Ω—É—é –¥–∞—Ç—É '
    '—Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –î–î.–ú–ú.–ì–ì–ì–ì',

    'bday_incorrect': '‚ùå<code>[–û–®–ò–ë–ö–ê]: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç.</code>\n'
    '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –í–∞—à—É —Ä–µ–∞–ª—å–Ω—É—é –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –î–î.–ú–ú.–ì–ì–ì–ì',

    'end_reg': '‚úÖ<code>[–£–°–ü–ï–®–ù–û]: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞.</code>\n'
    '–ù–∞ –æ—Å–Ω–æ–≤–µ –í–∞—à–µ–≥–æ –ø—Ä–æ—Ñ–∞–π–ª–∞ —Ç–µ–ø–µ—Ä—å —è —Å–º–æ–≥—É –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ '
    '—Å–æ–æ–±—â–µ–Ω–∏—è. –°–ª—É–∂–±–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 6:00 –ø–æ '
    '—á–∞—Å–æ–≤–æ–º—É –ø–æ—è—Å—É GMT+3 (–ú–æ—Å–∫–≤–∞). –†–∞–¥ –í–∞—Å –≤–∏–¥–µ—Ç—å –≤ —á–∏—Å–ª–µ –º–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π!'
}


class Message():
    def __init__(self, first_name, city, birthdate):
        self.name = first_name
        self.city = city
        self.birthdate = utils.standardize_birthdate(birthdate)
        self.zodiac = astronum.get_zodiac(utils.standardize_birthdate(birthdate))

    def create_horoscope_message(self):
        horoscope = content.get_horoscope(self.zodiac)
        zodiac = astronum.ZODIAC_DICT[self.zodiac][1]
        if horoscope != None:
            return (
                f'üåü<b>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è —Ä–æ–¥–∏–≤—à–∏—Ö—Å—è –ø–æ–¥ –∑–Ω–∞–∫–æ–º "{zodiac}":</b>'
                f'<i>\n{horoscope}</i>\n')
        else:
            return None
    
    def create_personal_data_message(self):
        zodiac = astronum.ZODIAC_DICT[self.zodiac]
        psycho_data = content.get_psychomatrix(self.name, self.birthdate)
        name_num = psycho_data['name_num']
        name_num_desc = psycho_data['name_num_desc']
        date_num = psycho_data['date_num']
        characteristic = psycho_data['date_num_desc']['characteristic']
        advantages = psycho_data['date_num_desc']['advantages']
        flaws = psycho_data['date_num_desc']['flaws']
        return (
            '‚úÖ<code>[–£–°–ü–ï–®–ù–û]: –ü—Ä–æ—Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω.</code>\n'
            f'<b>–§–ò–û:</b> <i>{self.name}</i>\n'
            f'<b>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</b> <i>{self.birthdate}</i>\n'
            f'<b>–ì–æ—Ä–æ–¥:</b> <i>{self.city}</i>\n'
            f'<b>–ó–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞:</b> <i>{zodiac[0]}{zodiac[1]}</i>\n\n'
            '<code>[–ü–°–ò–•–û–ê–ù–ê–õ–ò–ó –õ–ò–ß–ù–û–°–¢–ò –ù–ê –û–°–ù–û–í–ï –ù–£–ú–ï–†–û–õ–û–ì–ò–ò]:</code>\n'
            f'<b>–ß–∏c–ª–æ –∏–º–µ–Ω–∏:</b> <i>{name_num}</i>\n'
            f'<b>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –ø–æ —á–∏—Å–ª—É –∏–º–µ–Ω–∏:</b> <i>{name_num_desc}</i>\n\n'
            f'<b>–ß–∏c–ª–æ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è:</b> <i>{date_num}</i>\n'
            '<b>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –ø–æ —á–∏—Å–ª—É –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è:</b> '
            f'<i>{characteristic}</i>\n'
            f'<b>–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –ª–∏—á–Ω–æ—Å—Ç–∏:</b> <i>{advantages}</i>\n'
            f'<b>–°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –ª–∏—á–Ω–æ—Å—Ç–∏:</b> <i>{flaws}</i>\n'
        )
    
    def create_weather_message(self):
        weather_data = content.get_weather(self.city)
        icon = weather_data["condition"][0]
        if weather_data != None:
            return (
                f'{icon}<b>–ü–æ–≥–æ–¥–∞ –≤ –ª–æ–∫–∞—Ü–∏–∏ {self.city}:</b>\n<i>'
                f'{weather_data["condition"][1]}, —Å—Ä–µ–¥–Ω—è—è '
                f'—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–∑–¥—É—Ö–∞ —Å–µ–≥–æ–¥–Ω—è —Å–æ—Å—Ç–∞–≤–∏—Ç '
                f'{weather_data["temp_avg"]}¬∞C. –°–µ–π—á–∞—Å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–∑–¥—É—Ö–∞ '
                f'{weather_data["feels_like"]}¬∞C, —Å–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞ '
                f'{weather_data["wind_speed"]} –º/—Å, –ø–æ—Ä—ã–≤—ã –¥–æ '
                f'{weather_data["wind_gust"]} –º/—Å </i>\n'
                f'–í–æ—Å—Ö–æ–¥ —Å–æ–ª–Ω—Ü–∞ - <i>{weather_data["sunrise"]}</i>\n'
                f'–ó–∞–∫–∞—Ç - <i>{weather_data["sunset"]}</i>\n'
            )
        else:
            return None
    
    def create_quote_message(self):
        quote_data = content.get_quote()
        if quote_data != None:
            if len(quote_data['author']) > 1:
                return (
                    'ü§î<b>–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –º—ã—Å–ª—å –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:</b>\n'
                    f'''<i>"{quote_data['quote']}" - '''
                    f'''{quote_data['author']}</i>\n''' 
                )
            else:
                return (
                    'ü§î<b>–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –º—ã—Å–ª—å –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:</b>\n'
                    f'''<i>"{quote_data['quote']}"</i>\n''' 
                )
        else:
            return None
    
    def create_film_message(self):
        film_data = content.get_random_film()
        if film_data != None:
            genres = ''
            for genre in film_data['genres']:
                genres += genre + ', '
            genres = genres[:-2]
            return (
                'üì∫<b>–°–ª—É—á–∞–π–Ω–æ–µ –∫–∏–Ω–æ–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: '
                f'<a href="{film_data["link"]}">{film_data["title"]}, '
                f'{film_data["year"]}</a></b>\n'
                f'<b>–û–ø–∏—Å–∞–Ω–∏–µ:</b> <i>{film_data["description"]}</i>\n'
                f'<b>–ñ–∞–Ω—Ä:</b> <i>{genres}</i>\n'
                f'<b>–†–µ–π—Ç–∏–Ω–≥:</b> <i>{film_data["rating"]}</i>\n'
            )
        else:
            return None
        
    def create_daily_message(self):
        weather = self.create_weather_message()
        quote = self.create_quote_message()
        film = self.create_film_message()
        horoscope = self.create_horoscope_message()
        hi = f'–î–æ–±—Ä–æ–µ —É—Ç—Ä–µ—á–∫–æ, {self.name}üåû –ù–∞ —Å–≤—è–∑–∏ –î–µ–π–ªü§ñ\n '
        bye = '–•–æ—Ä–æ—à–µ–≥–æ –í–∞–º –¥–Ω—èüòä'
        return f'{hi}\n{weather}\n{horoscope}\n{quote}\n{film}\n{bye}'
